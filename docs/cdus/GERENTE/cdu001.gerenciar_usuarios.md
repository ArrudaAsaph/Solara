# **CDU001 – Gerenciar Usuários**

* **Ator principal**: Gerente
* **Atores secundários**: Sistema
* **Resumo**: Permite ao gerente realizar a gestão completa dos usuários operacionais da plataforma, incluindo cadastro, atualização de dados, ativação e desativação de acesso, definição de permissões e visualização da listagem de usuários vinculados à empresa.
* **Pré-condição**:

  * O gerente deve estar autenticado no sistema.
  * O gerente deve estar vinculado a uma empresa ativa.
  * O gerente deve estar ativo.
* **Pós-condição**:

  * Usuários são criados, atualizados, ativados ou desativados conforme as ações executadas, mantendo o histórico e respeitando as regras de negócio.

---
## **Mapeamento CDU -> Requisitos Funcionais**

| **Requisito** | **Descrição**               |
| ------------- | --------------------------- |
| RF01          | Cadastro de usuários        |
| RF02          | Atualização de usuários     |
| RF03          | Ativação e desativação      |
| RF05          | Listagem de usuários        |


---
## **Mapeamento CDU -> Regras de Negócio**
| **Código** | **Descrição**                                                                                                                                                | 
| :--------: | :----------------------------------------------------------------------------------------------------------------------------------------------------------- |
|  **RN01**  | Apenas gerentes e empresas podem cadastrar usuários no sistema.                                                                                              |
|  **RN02**  | Apenas empresas podem gerenciar usuários do tipo gerente (cadastrar, atualizar, listar, ativar/desativar e controlar permissões e perfil).                                                                                              |
|  **RN03**  | Não deve existir usuário que não esteja obrigatoriamente vinculado a uma pessoa ou a uma empresa.                                                            | 
|  **RN04**  | Não deve ser possível remover um usuário do sistema, apenas ativá-lo ou desativá-lo, preservando os dados históricos.                                        |
|  **RN05**  | O gerente pode cadastrar, atualizar, listar, ativar ou desativar apenas usuários vinculados à mesma empresa à qual ele pertence.                   |
|  **RN07**  | Não deve existir mais de um usuário com o mesmo e-mail ou identificador de acesso dentro da mesma empresa.                                                   |


---

## **Fluxo Principal**

|                **Ações do Ator**                |                                              **Ações do Sistema**                                              |
| :---------------------------------------------: | :------------------------------------------------------------------------------------------------------------: |
|     1 - Acessa a opção “Gerenciar Usuários”.    |                                                                                                                |
|                                                 |     2 - Exibe a listagem de usuários vinculados à empresa, com filtros por nome, tipo de usuário e status.     |
|    3 - Seleciona a opção “Cadastrar Usuário”.   |                                                                                                                |
|                                                 |          4 - Exibe formulário de cadastro com campos: nome, e-mail, tipo de usuário e sendo ativo por padrão.          |
|   5 - Preenche os dados e confirma o cadastro.  |                                                                                                                |
|                                                 | 6 - Valida as **Regras de Negócio**: **RN01**, **RN03**, **RN05** e **RN07** e cria o novo usuário no sistema. |
| 7 - Visualiza o usuário cadastrado na listagem. |                                                                                                                |

---

## **Fluxos Alternativos**

### **Fluxo Alternativo I – [Atualizar dados de usuário]**

|                 **Ações do Ator**                |                                                     **Ações do Sistema**                                                    |
| :----------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------: |
|      1.1 - Seleciona um usuário da listagem.     |                                                                                                                             |
|                                                  |                                         1.2 - Exibe os dados cadastrais do usuário.                                         |
|         1.3 - Seleciona a opção “Editar”.        |                                                                                                                             |
|                                                  |                                    1.4 - Exibe formulário de edição dos dados do usuário.                                   |
|     1.5 - Atualiza as informações e confirma.    |                                                                                                                             |
|                                                  | 1.6 - Valida as **Regras de Negócio**: **RN02**, **RN03**, **RN05** e **RN07**, registra o histórico e salva as alterações. |
| 1.7 - Visualiza os dados atualizados do usuário. |                                                                                                                             |

---

### **Fluxo Alternativo II – [Ativar ou Desativar usuário]**

|                 **Ações do Ator**                |                          **Ações do Sistema**                         |
| :----------------------------------------------: | :-------------------------------------------------------------------: |
|   2.1 - Seleciona um usuário ativo ou inativo.   |                                                                       |
| 2.2 - Seleciona a opção “Ativar” ou “Desativar”. |                                                                       |
|                                                  | 2.3 - Valida as **Regras de Negócio**: **RN04**e **RN05**. |
|                                                  |      2.4 - Atualiza o status do usuário preservando o histórico.      |
|   2.5 - Visualiza o usuário com o novo status.   |                                                                       |

---


### **Fluxo Alternativo III – [Listar usuários]**

|            **Ações do Ator**            |                    **Ações do Sistema**                   |
| :-------------------------------------: | :-------------------------------------------------------: |
| 4.1 - Acessa a opção “Listar Usuários”. |                                                           |
|                                         |  4.2 - Recupera usuários vinculados à empresa do gerente. |
|                                         | 4.3 - Exibe listagem com filtros por status, tipo e nome. |
| 4.4 - Visualiza a listagem de usuários. |                                                           |

---

## **Fluxos de Exceção**

### **Fluxo de Exceção I – [Falha na validação do cadastro ou edição]**

|                       **Ações do Ator**                       |                                **Ações do Sistema**                               |
| :-----------------------------------------------------------: | :-------------------------------------------------------------------------------: |
| 0.1 - Preenche formulário com dados inválidos ou incompletos. |                                                                                   |
|                                                               |                 0.2 - Valida as **Regras de Negócio** aplicáveis.                 |
|                                                               | 0.3 - Exibe mensagens de erro indicando campos inválidos ou duplicidade de dados. |
|               0.4 - Corrige os dados informados.              |                                                                                   |

---

### **Fluxo de Exceção II – [Tentativa de gerenciar usuário fora da empresa]**

|                     **Ações do Ator**                    |                        **Ações do Sistema**                        |
| :------------------------------------------------------: | :----------------------------------------------------------------: |
| 1.e - Tenta acessar usuário não vinculado à sua empresa. |                                                                    |
|                                                          |             1.e.1 - Valida a **Regra de Negócio RN05**.            |
|                                                          | 1.e.2 - Bloqueia a ação e exibe mensagem de acesso não autorizado. |

---
