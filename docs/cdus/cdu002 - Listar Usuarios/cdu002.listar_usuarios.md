# CDU002 – Listar Usuários

> **Arquivo:** `cdu002_listar_usuarios.md`
> **Descrição:** Caso de uso referente à listagem de usuários. Pode ser executado por **Empresa**, **Gerente** e **Analistas (Energético e Financeiro)**, com escopos diferentes conforme o ator.

---

## Identificação

| **Campo** | **Valor** |
| :-------- | :-------- |
| **Código** | CDU002 |
| **Ator Principal** | Empresa / Gerente / Analista Energético / Analista Financeiro |
| **Atores Secundários** | Sistema |
| **Requisito Atendido** | [RF05](../../requisitos/requisitos_funcionais.md#rf05) / [RF17](../../requisitos/requisitos_funcionais.md#rf17) |

---

## Resumo

Permite ao ator listar usuários conforme seu escopo de acesso, podendo aplicar filtros por nome, tipo de usuário e status (ativo ou inativo).

- **Empresa:** visualiza todos os usuários da empresa, incluindo gerentes.
- **Gerente:** visualiza apenas usuários de nível inferior ao seu, vinculados à mesma empresa.
- **Analistas (Energético e Financeiro):** visualizam apenas usuários vinculados às usinas às quais também estão vinculados.

---

## Pré-condições

- O ator deve estar autenticado no sistema.
- O ator deve estar vinculado a uma empresa ativa.
- O ator deve estar ativo.

---

## Pós-condições

- A listagem de usuários vinculados à empresa é exibida conforme o escopo do ator e os filtros aplicados.
- Nenhum dado é alterado no sistema.

---

## Mapeamento: CDU → Requisitos Funcionais

| **Requisito** | **Descrição** |
| :------------ | :------------ |
| [**RF05**](../../requisitos/requisitos_funcionais.md#rf05) | A empresa ou o gerente pode listar todos os usuários cadastrados vinculados à empresa, podendo usar filtros para a listagem. |
| [**RF17**](../../requisitos/requisitos_funcionais.md#rf17) | O analista pode listar apenas usuários vinculados às usinas às quais ele também está vinculado, sem acesso a usuários fora desse escopo. |

---

## Mapeamento: CDU → Regras de Negócio

| **Código** | **Descrição** |
| :--------: | :------------ |
| [**RN02**](../../regras_de_negocio/regras_de_negocio.md#rn02) | Apenas empresas podem visualizar e gerenciar usuários do tipo gerente. O gerente não visualiza outros gerentes na listagem. |
| [**RN05**](../../regras_de_negocio/regras_de_negocio.md#rn05) | O gerente pode listar apenas usuários vinculados à mesma empresa à qual ele pertence. |
| [**RN16**](../../regras_de_negocio/regras_de_negocio.md#rn16) | Apenas empresa e gerente podem gerenciar usuários por hierarquia; o gerente só visualiza usuários de nível inferior. |
| [**RN20**](../../regras_de_negocio/regras_de_negocio.md#rn20) | Analistas podem listar apenas usuários vinculados às usinas às quais também estão vinculados, sem visualizar Empresa ou Gerente. |

---

## Fluxo Principal

| **Passo** | **Ações do Ator** | **Ações do Sistema** |
| :-------: | :---------------- | :------------------- |
| 1 | Acessa a opção "Listar Usuários". | |
| 2 | | Recupera os usuários conforme o escopo do ator: empresa (todos da empresa), gerente (apenas níveis inferiores) e analista (apenas vinculados às usinas às quais está vinculado). |
| 3 | | Aplica filtros padrão (se houver). |
| 4 | | Exibe a listagem com as informações: nome, e-mail, tipo de usuário e status. |
| 5 | Aplica filtros por nome, tipo de usuário ou status (opcional). | |
| 6 | | Atualiza a listagem conforme os filtros aplicados. |
| 7 | Visualiza os resultados da listagem. | |

---

## Fluxos de Exceção

### Fluxo de Exceção I – Tentativa de acesso a usuários fora do escopo

| **Passo** | **Ações do Ator** | **Ações do Sistema** |
| :-------: | :---------------- | :------------------- |
| 0.1 | Tenta acessar listagem contendo usuários não vinculados à sua empresa ou de nível hierárquico igual/superior. | |
| 0.2 | | Valida as Regras de Negócio [**RN05**](../../regras_de_negocio/regras_de_negocio.md#rn05), [**RN16**](../../regras_de_negocio/regras_de_negocio.md#rn16) e [**RN20**](../../regras_de_negocio/regras_de_negocio.md#rn20). |
| 0.3 | | Bloqueia a exibição e apresenta mensagem de acesso não autorizado. |
